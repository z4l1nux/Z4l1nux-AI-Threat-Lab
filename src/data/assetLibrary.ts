/**
 * Biblioteca de Assets Predefinidos para Threat Modeling
 * Focado em sistemas com IA/ML e aplica√ß√µes web/empresariais
 */

import { Asset } from '../types/visual';

export const AI_ML_ASSETS: Asset[] = [
  {
    id: 'llm-model',
    label: 'LLM Model',
    icon: 'üß†',
    category: 'ai',
    description: 'Large Language Model (GPT, Claude, Gemini, etc.)',
    typicalThreats: ['LLM01', 'LLM03', 'LLM04', 'LLM06', 'LLM10', 'Information Disclosure'],
    color: '#8b5cf6'
  },
  {
    id: 'trained-model',
    label: 'Trained Model',
    icon: 'üéØ',
    category: 'ai',
    description: 'Machine Learning model treinado customizado',
    typicalThreats: ['LLM03', 'LLM10', 'Tampering'],
    color: '#8b5cf6'
  },
  {
    id: 'embedding-model',
    label: 'Embedding Model',
    icon: 'üî¢',
    category: 'ai',
    description: 'Modelo de embeddings para RAG/busca vetorial',
    typicalThreats: ['LLM06', 'Information Disclosure'],
    color: '#8b5cf6'
  },
  {
    id: 'ai-agent',
    label: 'AI Agent',
    icon: 'ü§ñ',
    category: 'ai',
    description: 'Agente aut√¥nomo com LLM',
    typicalThreats: ['LLM08', 'LLM01', 'Elevation of Privilege'],
    color: '#8b5cf6'
  },
  {
    id: 'prompt-manager',
    label: 'Prompt Manager',
    icon: 'üìù',
    category: 'ai',
    description: 'Sistema de gerenciamento de prompts',
    typicalThreats: ['LLM01', 'Tampering'],
    color: '#8b5cf6'
  }
];

export const DATA_ASSETS: Asset[] = [
  {
    id: 'training-data',
    label: 'Training Data',
    icon: 'üìä',
    category: 'data',
    description: 'Dataset usado para treinar modelos',
    typicalThreats: ['LLM03', 'LLM06', 'Information Disclosure'],
    color: '#10b981'
  },
  {
    id: 'evaluation-data',
    label: 'Evaluation Data',
    icon: 'üìà',
    category: 'data',
    description: 'Dataset de avalia√ß√£o/teste',
    typicalThreats: ['Information Disclosure', 'Tampering'],
    color: '#10b981'
  },
  {
    id: 'raw-data',
    label: 'Raw Data',
    icon: 'üìÅ',
    category: 'data',
    description: 'Dados brutos n√£o processados',
    typicalThreats: ['Information Disclosure', 'Tampering'],
    color: '#10b981'
  },
  {
    id: 'preprocessed-data',
    label: 'Pre-processed Data',
    icon: 'üîÑ',
    category: 'data',
    description: 'Dados limpos e preparados',
    typicalThreats: ['LLM03', 'Tampering'],
    color: '#10b981'
  },
  {
    id: 'user-data',
    label: 'User Data',
    icon: 'üë§',
    category: 'data',
    description: 'Dados de usu√°rios/clientes',
    typicalThreats: ['Information Disclosure', 'Spoofing', 'Repudiation'],
    color: '#10b981'
  },
  {
    id: 'sensitive-data',
    label: 'Sensitive Data',
    icon: 'üîí',
    category: 'data',
    description: 'Dados sens√≠veis (PII, credenciais)',
    typicalThreats: ['Information Disclosure', 'Tampering', 'Spoofing'],
    color: '#10b981'
  }
];

export const STORAGE_ASSETS: Asset[] = [
  {
    id: 'vector-database',
    label: 'Vector Database',
    icon: 'üóÉÔ∏è',
    category: 'storage',
    description: 'Banco vetorial (Pinecone, Weaviate, Chroma, Neo4j)',
    typicalThreats: ['LLM06', 'Information Disclosure', 'Tampering'],
    color: '#f59e0b'
  },
  {
    id: 'database',
    label: 'Database',
    icon: 'üíæ',
    category: 'storage',
    description: 'Banco de dados relacional/NoSQL',
    typicalThreats: ['Information Disclosure', 'Tampering', 'Denial of Service'],
    color: '#f59e0b'
  },
  {
    id: 'data-lake',
    label: 'Data Lake',
    icon: 'üèûÔ∏è',
    category: 'storage',
    description: 'Data Lake para big data',
    typicalThreats: ['Information Disclosure', 'Tampering'],
    color: '#f59e0b'
  },
  {
    id: 'cache',
    label: 'Cache',
    icon: '‚ö°',
    category: 'storage',
    description: 'Sistema de cache (Redis, Memcached)',
    typicalThreats: ['Information Disclosure', 'Denial of Service'],
    color: '#f59e0b'
  },
  {
    id: 'model-registry',
    label: 'Model Registry',
    icon: 'üìö',
    category: 'storage',
    description: 'Registry de modelos (MLflow, Weights & Biases)',
    typicalThreats: ['LLM05', 'LLM10', 'Tampering'],
    color: '#f59e0b'
  },
  {
    id: 'file-storage',
    label: 'File Storage',
    icon: 'üì¶',
    category: 'storage',
    description: 'Armazenamento de arquivos',
    typicalThreats: ['Information Disclosure', 'Tampering'],
    color: '#f59e0b'
  }
];

export const SERVICE_ASSETS: Asset[] = [
  {
    id: 'web-app',
    label: 'Web Application',
    icon: 'üåê',
    category: 'service',
    description: 'Aplica√ß√£o web frontend',
    typicalThreats: ['Spoofing', 'Tampering', 'Information Disclosure'],
    color: '#3b82f6'
  },
  {
    id: 'mobile-app',
    label: 'Mobile App',
    icon: 'üì±',
    category: 'service',
    description: 'Aplicativo mobile',
    typicalThreats: ['Spoofing', 'Tampering', 'Repudiation'],
    color: '#3b82f6'
  },
  {
    id: 'api-gateway',
    label: 'API Gateway',
    icon: 'üö™',
    category: 'service',
    description: 'Gateway de APIs',
    typicalThreats: ['Spoofing', 'Denial of Service', 'Elevation of Privilege'],
    color: '#3b82f6'
  },
  {
    id: 'backend-service',
    label: 'Backend Service',
    icon: '‚öôÔ∏è',
    category: 'service',
    description: 'Servi√ßo backend/microservi√ßo',
    typicalThreats: ['Elevation of Privilege', 'Tampering', 'Denial of Service'],
    color: '#3b82f6'
  },
  {
    id: 'auth-service',
    label: 'Auth Service',
    icon: 'üîê',
    category: 'service',
    description: 'Servi√ßo de autentica√ß√£o/autoriza√ß√£o',
    typicalThreats: ['Spoofing', 'Elevation of Privilege', 'Repudiation'],
    color: '#3b82f6'
  },
  {
    id: 'ml-pipeline',
    label: 'ML Pipeline',
    icon: 'üîß',
    category: 'service',
    description: 'Pipeline de ML/MLOps',
    typicalThreats: ['LLM03', 'LLM05', 'Tampering'],
    color: '#3b82f6'
  },
  {
    id: 'load-balancer',
    label: 'Load Balancer',
    icon: '‚öñÔ∏è',
    category: 'service',
    description: 'Balanceador de carga',
    typicalThreats: ['Denial of Service', 'Spoofing'],
    color: '#3b82f6'
  },
  {
    id: 'message-queue',
    label: 'Message Queue',
    icon: 'üì¨',
    category: 'service',
    description: 'Fila de mensagens (RabbitMQ, Kafka)',
    typicalThreats: ['Tampering', 'Information Disclosure', 'Repudiation'],
    color: '#3b82f6'
  }
];

export const EXTERNAL_ASSETS: Asset[] = [
  {
    id: 'openai-api',
    label: 'OpenAI API',
    icon: 'üîå',
    category: 'external',
    description: 'API externa OpenAI (GPT)',
    typicalThreats: ['LLM05', 'LLM06', 'Information Disclosure'],
    color: '#ef4444'
  },
  {
    id: 'anthropic-api',
    label: 'Anthropic API',
    icon: 'üîå',
    category: 'external',
    description: 'API externa Anthropic (Claude)',
    typicalThreats: ['LLM05', 'LLM06', 'Information Disclosure'],
    color: '#ef4444'
  },
  {
    id: 'google-api',
    label: 'Google AI API',
    icon: 'üîå',
    category: 'external',
    description: 'API externa Google (Gemini)',
    typicalThreats: ['LLM05', 'LLM06', 'Information Disclosure'],
    color: '#ef4444'
  },
  {
    id: 'third-party-api',
    label: 'Third-party API',
    icon: 'üîó',
    category: 'external',
    description: 'API de terceiros gen√©rica',
    typicalThreats: ['LLM05', 'Information Disclosure', 'Spoofing'],
    color: '#ef4444'
  },
  {
    id: 'huggingface',
    label: 'Hugging Face',
    icon: 'ü§ó',
    category: 'external',
    description: 'Hugging Face Hub (modelos)',
    typicalThreats: ['LLM05', 'LLM03', 'Tampering'],
    color: '#ef4444'
  },
  {
    id: 'cloud-storage',
    label: 'Cloud Storage',
    icon: '‚òÅÔ∏è',
    category: 'external',
    description: 'Storage em nuvem (S3, GCS, Azure)',
    typicalThreats: ['Information Disclosure', 'Tampering'],
    color: '#ef4444'
  },
  {
    id: 'payment-gateway',
    label: 'Payment Gateway',
    icon: 'üí≥',
    category: 'external',
    description: 'Gateway de pagamento',
    typicalThreats: ['Spoofing', 'Tampering', 'Information Disclosure'],
    color: '#ef4444'
  },
  {
    id: 'oauth-provider',
    label: 'OAuth Provider',
    icon: 'üîë',
    category: 'external',
    description: 'Provedor OAuth (Google, GitHub)',
    typicalThreats: ['Spoofing', 'Elevation of Privilege'],
    color: '#ef4444'
  }
];

export const USER_ASSETS: Asset[] = [
  {
    id: 'end-user',
    label: 'End User',
    icon: 'üë®‚Äçüíª',
    category: 'user',
    description: 'Usu√°rio final do sistema',
    typicalThreats: ['LLM01', 'LLM09', 'Spoofing'],
    color: '#64748b'
  },
  {
    id: 'admin',
    label: 'Administrator',
    icon: 'üë®‚Äçüíº',
    category: 'user',
    description: 'Administrador do sistema',
    typicalThreats: ['Elevation of Privilege', 'Repudiation'],
    color: '#64748b'
  },
  {
    id: 'data-scientist',
    label: 'Data Scientist',
    icon: 'üë®‚Äçüî¨',
    category: 'user',
    description: 'Cientista de dados',
    typicalThreats: ['LLM03', 'Information Disclosure'],
    color: '#64748b'
  },
  {
    id: 'attacker',
    label: 'Attacker',
    icon: 'ü¶π',
    category: 'user',
    description: 'Atacante/advers√°rio',
    typicalThreats: ['Spoofing', 'Tampering', 'Information Disclosure'],
    color: '#dc2626'
  },
  {
    id: 'developer',
    label: 'Developer',
    icon: 'üë®‚Äçüíª',
    category: 'user',
    description: 'Desenvolvedor',
    typicalThreats: ['Tampering', 'Elevation of Privilege'],
    color: '#64748b'
  }
];

export const ALL_ASSETS: Asset[] = [
  ...AI_ML_ASSETS,
  ...DATA_ASSETS,
  ...STORAGE_ASSETS,
  ...SERVICE_ASSETS,
  ...EXTERNAL_ASSETS,
  ...USER_ASSETS
];

export const ASSET_CATEGORIES = [
  { id: 'ai', label: 'AI/ML', icon: 'ü§ñ', color: '#8b5cf6' },
  { id: 'data', label: 'Data', icon: 'üìä', color: '#10b981' },
  { id: 'storage', label: 'Storage', icon: 'üíæ', color: '#f59e0b' },
  { id: 'service', label: 'Services', icon: '‚öôÔ∏è', color: '#3b82f6' },
  { id: 'external', label: 'External', icon: 'üîó', color: '#ef4444' },
  { id: 'user', label: 'Users', icon: 'üë§', color: '#64748b' }
];

export function getAssetById(id: string): Asset | undefined {
  return ALL_ASSETS.find(asset => asset.id === id);
}

export function getAssetsByCategory(category: Asset['category']): Asset[] {
  return ALL_ASSETS.filter(asset => asset.category === category);
}

